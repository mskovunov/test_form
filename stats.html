<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

    <script>
        // –ö–æ–¥ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –∏ –º–µ–Ω—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏.
        function toggleTheme() {
            const isDark = document.body.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        function toggleMenu() {
            const menu = document.getElementById("sideMenu");
            menu.classList.toggle("open");
        }

        window.addEventListener('DOMContentLoaded', () => {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Ç–µ–º—ã
            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark');
            }
        });
    </script>
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-N0T0138X0Q"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-N0T0138X0Q');
	</script>
</head>
<body>
    <div class="container">
        <button class="menu-button" onclick="toggleMenu()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M4 6H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4 12H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>

        <div class="form-wrapper">

            <div class="side-menu" id="sideMenu">
                <button class="close-button" onclick="toggleMenu()">‚ùå</button>
                <ul>
					<li><a href="index.html">üè† –ì–æ–ª–æ–≤–Ω–∞</a></li> 
                    <li><a href="history.html">üìú –Ü—Å—Ç–æ—Ä—ñ—è</a></li> 
                    <li><a href="stats.html">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a></li> 
                    <li><a href="settings.html">‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</a></li>
					<li><a href="#" onclick="handleExit()">üö™ –í–∏—Ö—ñ–¥</a></li> 
                </ul>
                <button type="button" class="theme-toggle" onclick="toggleTheme()">üåì –ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É</button>
            </div>

            <h2>–î–∏–Ω–∞–º—ñ–∫–∞ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è (–≥—Ä–Ω/–∫–í—Ç)</h2>

            <div class="chart-container-scroll">
                <iframe 
                    width="1000px" 
                    height="600" 
                    seamless 
                    frameborder="0" 
                    scrolling="no" 
                    src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS_qJElkXRDX_zVtDHpMVcclSpo2KRNef03sZ_kbfrEbdO-C8XvqSvJyLzXwmLNfSHHVkCD0RA5Kbsy/pubchart?oid=268230450&amp;format=interactive"
                ></iframe>
            </div>
            
        </div>
    </div>
	
	<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
	<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
	<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>	
	<script src="./firebase-init.js"></script>
	
	<script>
	
		// --- –§–£–ù–ö–¶–ò–Ø: –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã (Logout) ---
		async function handleLogout() {
			try {
				await auth.signOut();
				console.log("–£—Å–ø–µ—à–Ω—ã–π –≤—ã—Ö–æ–¥ –∏–∑ Firebase.");
				
				// –ü–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
				window.location.replace('auth.html'); 
				
			} catch (error) {
				console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ Firebase:", error);
				alert("–ü–æ–º–∏–ª–∫–∞ –≤–∏—Ö–æ–¥—É: " + error.message);
			}
		}
		/* --- –î–û–ë–ê–í–õ–ï–ù–û: –§–£–ù–ö–¶–ò–Ø –ó–ê–ö–†–´–¢–ò–Ø WEBVIEW --- */
		function closeWebView() {
			console.log("Attempting to close WebView...");
			// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ Android-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
			if (typeof Android !== 'undefined' && Android.closeApp) {
				Android.closeApp();
			} else {
				// Fallback –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞
				console.warn("Native Android closeApp interface not found. Cannot close application.");
			}
		}
		
		// –ù–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –º–µ–Ω—é "–í–∏—Ö—ñ–¥"
		function handleExit() {
			// –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å "–í–∏—Ö—ñ–¥":
			// 1. –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –≤—ã—Ö–æ–¥ –∏–∑ —Å–µ—Å—Å–∏–∏:
			handleLogout(); 
			
			// 2. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∫–∞–∫ –≤ –≤–∞—à–µ–º —Å—Ç–∞—Ä–æ–º –∫–æ–¥–µ):
			// closeWebView();
		}
		
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    auth.onAuthStateChanged((user) => {
        if (!user) {
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
            console.log("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞.");
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
            window.location.replace('auth.html'); 
        } else {
            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
            console.log("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∫–∞–∫:", user.email);
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–¥ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ Firestore)
        }
    });

    // // (–í–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ GAS –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∏–∂–µ —ç—Ç–æ–≥–æ –±–ª–æ–∫–∞)
	</script>
</body>

</html>

