<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <title>Статистика споживання</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />

    <script>
      window.addEventListener("DOMContentLoaded", async () => {
        // Загрузка сохраненной темы
        if (localStorage.getItem("theme") === "dark") {
          document.body.classList.add("dark");
        }
        await loadComponent("sidebar-placeholder", "sidebar.html");
      });
    </script>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-N0T0138X0Q"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-N0T0138X0Q");
    </script>
  </head>
  <body>
    <div class="container">
      <button class="menu-button" onclick="toggleMenu()">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M4 6H20"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M4 12H20"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M4 18H20"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>

      <div class="form-wrapper">
        <!-- Боковое меню зачитываем из utils.js-->
        <div id="sidebar-placeholder"></div>

        <h2>Динаміка споживання (грн/кВт)</h2>

        <div class="chart-container-scroll">
          <iframe
            width="1000px"
            height="600"
            seamless
            frameborder="0"
            scrolling="no"
            src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS_qJElkXRDX_zVtDHpMVcclSpo2KRNef03sZ_kbfrEbdO-C8XvqSvJyLzXwmLNfSHHVkCD0RA5Kbsy/pubchart?oid=268230450&amp;format=interactive"
          ></iframe>
        </div>
      </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="./firebase-init.js"></script>
    <script src="utils.js"></script>

    <script>
      // Проверка статуса авторизации при загрузке страницы
      auth.onAuthStateChanged((user) => {
        if (!user) {
          // Если пользователь НЕ авторизован
          console.log(
            "Пользователь не авторизован. Перенаправление на страницу входа."
          );
          // Перенаправить на страницу входа
          window.location.replace("auth.html");
        } else {
          // Пользователь авторизован
          console.log("Пользователь авторизован как:", user.email);
          // Здесь можно выполнять код для авторизованных пользователей (например, загрузку данных из Firestore)
        }
      });

      // // (Ваш существующий код для загрузки данных из GAS должен быть ниже этого блока)
    </script>
  </body>
</html>
