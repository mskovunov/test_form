<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–Ü—Å—Ç–æ—Ä—ñ—è –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

    <script>
        const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbyvl_C5rbp6v9Xk_zHv-cbxNNhvbgXCzghiq7gxXol-AynQDOZWYdNuf9-ECriA7J0G/exec';

        // –°–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤, –Ω–∞ –æ—Å–Ω–æ–≤–µ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ 2025 –≥–æ–¥
        const MONTHS = [
		    { value: "2025-10", text: "–ñ–æ–≤—Ç–µ–Ω—å 2025" }, // <--- –î–û–ë–ê–í–õ–ï–ù–û
            { value: "2025-09", text: "–í–µ—Ä–µ—Å–µ–Ω—å 2025" },
            { value: "2025-08", text: "–°–µ—Ä–ø–µ–Ω—å 2025" },
            { value: "2025-07", text: "–õ–∏–ø–µ–Ω—å 2025" },
            { value: "2025-06", text: "–ß–µ—Ä–≤–µ–Ω—å 2025" },
            { value: "2025-05", text: "–¢—Ä–∞–≤–µ–Ω—å 2025" },
            { value: "2025-04", text: "–ö–≤—ñ—Ç–µ–Ω—å 2025" },
            { value: "2025-03", text: "–ë–µ—Ä–µ–∑–µ–Ω—å 2025" },
            { value: "2025-02", text: "–õ—é—Ç–∏–π 2025" },
        ];

        function populateMonthSelector() {
            const selector = document.getElementById('monthSelector');
            
          

            // –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Å—è—Ü—ã
            MONTHS.forEach(month => {
                const option = document.createElement('option');
                option.value = month.value;
                option.textContent = month.text;
                selector.appendChild(option);
            });
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü (–°–µ–Ω—Ç—è–±—Ä—å) –∫–∞–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            selector.value = MONTHS[0].value;
        }

       // history.html (–≤–Ω—É—Ç—Ä–∏ <script>)

async function loadHistory() {
    const historyDiv = document.getElementById('history');
    const statusDiv = document.getElementById('loadingStatus');
    const monthSelector = document.getElementById('monthSelector');
    
    const selectedMonth = monthSelector.value;
    const monthName = monthSelector.options[monthSelector.selectedIndex].text;

    statusDiv.innerHTML = `‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó –∑–∞ ${monthName}...`;
    statusDiv.style.display = 'block';
    historyDiv.innerHTML = ''; 

    let url = WEBAPP_URL + '?history=1';
    
    // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–µ—Å—è—Ü, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ URL
    if (selectedMonth) {
        url += `&month=${selectedMonth}`;
    } else {
        // –ò–ó–ú–ï–ù–ï–ù–ò–ï –ó–î–ï–°–¨: –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –≤—Å—è –∏—Å—Ç–æ—Ä–∏—è
        statusDiv.innerHTML = `‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —É—Å—ñ—î—ó —ñ—Å—Ç–æ—Ä—ñ—ó...`; 
    }

    try {
        const resp = await fetch(url);
        const html = await resp.text();
        
        // ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –ø—É—Å—Ç–æ—Ç—É) ...

        if (html.trim() === '' || html.length < 50) { 
             // –≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ "–£—Å—è —ñ—Å—Ç–æ—Ä—ñ—è", –∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç.
             historyDiv.innerHTML = `<p style="text-align: center; color: var(--text-color); margin-top: 30px;">–ó–∞–ø–∏—Å—ñ–≤ –∑–∞ ${monthName} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</p>`;
        } else {
             historyDiv.innerHTML = html;
        }

        statusDiv.style.display = 'none';

    } catch (err) {
        statusDiv.innerHTML = '<p>‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —ñ—Å—Ç–æ—Ä—ñ—ó.</p>';
        console.error('–ü–æ–º–∏–ª–∫–∞ —ñ—Å—Ç–æ—Ä—ñ—ó:', err);
    }
}
        
        function toggleTheme() {
            const isDark = document.body.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        function toggleMenu() {
            const menu = document.getElementById("sideMenu");
            menu.classList.toggle("open");
        }

        window.addEventListener('DOMContentLoaded', () => {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Ç–µ–º—ã
            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark');
            }
            
            populateMonthSelector(); 
            loadHistory(); // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–µ—Å—è—Ü–∞
        });
    </script>
</head>
<body>
    <div class="container">
        <button class="menu-button" onclick="toggleMenu()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M4 6H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4 12H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>

        <div class="form-wrapper">
            <div class="side-menu" id="sideMenu">
                <button class="close-button" onclick="toggleMenu()">‚ùå</button>
                <ul>
                    <li><a href="index.html">üè† –ì–æ–ª–æ–≤–Ω–∞</a></li> 
                    <li><a href="history.html">üìú –Ü—Å—Ç–æ—Ä—ñ—è</a></li> 
                    <li><a href="stats.html">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a></li>
                    <li><a href="settings.html">‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</a></li>
                </ul>
                <button type="button" class="theme-toggle" onclick="toggleTheme()">üåì –ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É</button>
            </div>

            <h2>–Ü—Å—Ç–æ—Ä—ñ—è –ø–µ—Ä–µ–¥–∞—á—ñ –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤</h2>
            
            <div style="margin-bottom: 20px; text-align: left;">
                <label for="monthSelector" style="font-weight: bold; margin-bottom: 5px;">–í–∏–±—Ä–∞—Ç–∏ –ø–µ—Ä—ñ–æ–¥:</label>
                <select id="monthSelector" onchange="loadHistory()">
                    </select>
            </div>
            
            <div id="loadingStatus" style="display:none; text-align:center; padding: 20px;"></div>
            
            <div id="history"></div>

        </div>
    </div>
</body>
</html>